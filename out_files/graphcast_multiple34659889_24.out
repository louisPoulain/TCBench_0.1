2023-10-25 22:52:40,446 INFO Writing results to /scratch/lpoulain/graphcast/graphcast_d_20191128_t_0000_{step}h.grib.
/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/gribapi/__init__.py:23: UserWarning: ecCodes 2.31.0 or higher is recommended. You are running version 2.30.0
  warnings.warn(
2023-10-25 22:52:41,137 INFO Model description: 
GraphCast model at 0.25deg resolution, with 13 pressure levels. This model is
trained on ERA5 data from 1979 to 2017, and fine-tuned on HRES-fc0 data from
2016 to 2021 and can be causally evaluated on 2022 and later years. This model
does not take `total_precipitation_6hr` as inputs and can make predictions in an
operational setting (i.e., initialised from HRES-fc0).

2023-10-25 22:52:41,137 INFO Model license: 
The model weights are licensed under the Creative Commons
Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0). You
may obtain a copy of the License at:
https://creativecommons.org/licenses/by-nc-sa/4.0/.
The weights were trained on ERA5 data, see README for attribution statement.

2023-10-25 22:52:41,138 INFO Loading params/GraphCast_operational - ERA5-HRES 1979-2021 - resolution 0.25 - pressure levels 13 - mesh 2to6 - precipitation output only.npz: 0.7 second.
2023-10-25 22:52:41,138 INFO Building model: 0.7 second.
2023-10-25 22:52:41,138 INFO Loading surface fields from CDS
2023-10-25 22:52:41,871 INFO Welcome to the CDS
2023-10-25 22:52:41,871 INFO Welcome to the CDS
2023-10-25 22:52:41,872 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:52:41,872 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:52:41,926 INFO Request is queued
2023-10-25 22:52:41,926 INFO Request is queued
2023-10-25 22:52:42,946 INFO Request is running
2023-10-25 22:52:42,946 INFO Request is running
2023-10-25 22:52:44,468 INFO Request is completed
2023-10-25 22:52:44,468 INFO Request is completed
2023-10-25 22:52:44,468 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data0/adaptor.mars.internal-1698267162.7056477-20029-11-f42e557d-6243-4fac-9261-02dd0eaa520a.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-75749a24f9f3a07dd4ded1f4622871ca2dc13b540ffc37fc7ef730725a00c6f5.cache.tmp (15.8M)
2023-10-25 22:52:44,468 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data0/adaptor.mars.internal-1698267162.7056477-20029-11-f42e557d-6243-4fac-9261-02dd0eaa520a.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-75749a24f9f3a07dd4ded1f4622871ca2dc13b540ffc37fc7ef730725a00c6f5.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s]  8%|▊         | 1.31M/15.8M [00:00<00:01, 13.8MB/s] 50%|████▉     | 7.85M/15.8M [00:00<00:00, 46.0MB/s] 92%|█████████▏| 14.6M/15.8M [00:00<00:00, 57.5MB/s]                                                    2023-10-25 22:52:44,887 INFO Download rate 37.8M/s
2023-10-25 22:52:44,887 INFO Download rate 37.8M/s
2023-10-25 22:52:44,952 INFO Welcome to the CDS
2023-10-25 22:52:44,952 INFO Welcome to the CDS
2023-10-25 22:52:44,952 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:52:44,952 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:52:45,011 INFO Request is queued
2023-10-25 22:52:45,011 INFO Request is queued
2023-10-25 22:52:46,033 INFO Request is running
2023-10-25 22:52:46,033 INFO Request is running
2023-10-25 22:52:47,556 INFO Request is completed
2023-10-25 22:52:47,556 INFO Request is completed
2023-10-25 22:52:47,556 INFO Downloading https://download-0007-clone.copernicus-climate.eu/cache-compute-0007/cache/data8/adaptor.mars.internal-1698267165.2726896-12628-8-5fa050f6-e953-4b4a-b3cc-208d84c49fcd.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-85b394ff0adb4c4e643b6e82ea8b9e91820a11c1b8173f84aad365c3ce672325.cache.tmp (15.8M)
2023-10-25 22:52:47,556 INFO Downloading https://download-0007-clone.copernicus-climate.eu/cache-compute-0007/cache/data8/adaptor.mars.internal-1698267165.2726896-12628-8-5fa050f6-e953-4b4a-b3cc-208d84c49fcd.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-85b394ff0adb4c4e643b6e82ea8b9e91820a11c1b8173f84aad365c3ce672325.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s]  9%|▊         | 1.37M/15.8M [00:00<00:01, 14.4MB/s] 51%|█████     | 8.05M/15.8M [00:00<00:00, 47.1MB/s] 94%|█████████▍| 14.9M/15.8M [00:00<00:00, 58.4MB/s]                                                    2023-10-25 22:52:47,962 INFO Download rate 39.3M/s
2023-10-25 22:52:47,962 INFO Download rate 39.3M/s
2023-10-25 22:52:47,990 INFO Loading pressure fields from CDS
2023-10-25 22:52:48,009 INFO Welcome to the CDS
2023-10-25 22:52:48,009 INFO Welcome to the CDS
2023-10-25 22:52:48,009 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:52:48,009 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:52:48,041 INFO Request is queued
2023-10-25 22:52:48,041 INFO Request is queued
2023-10-25 22:52:49,062 INFO Request is running
2023-10-25 22:52:49,062 INFO Request is running
2023-10-25 22:52:56,253 INFO Request is completed
2023-10-25 22:52:56,253 INFO Request is completed
2023-10-25 22:52:56,253 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data7/adaptor.mars.internal-1698267168.578728-20356-14-1ed49fac-a4f9-49c6-95bd-ff80e6362079.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-8a29d5f3e0c6d10e18c9d5bc9a323d82c03cb53f3b03e27b2aaa2f7a9a639324.cache.tmp (154.5M)
2023-10-25 22:52:56,253 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data7/adaptor.mars.internal-1698267168.578728-20356-14-1ed49fac-a4f9-49c6-95bd-ff80e6362079.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-8a29d5f3e0c6d10e18c9d5bc9a323d82c03cb53f3b03e27b2aaa2f7a9a639324.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  1%|          | 1.62M/154M [00:00<00:09, 16.7MB/s]  5%|▍         | 7.53M/154M [00:00<00:03, 43.1MB/s]  8%|▊         | 11.7M/154M [00:00<00:06, 23.4MB/s] 11%|█         | 16.8M/154M [00:00<00:04, 31.3MB/s] 14%|█▎        | 20.9M/154M [00:00<00:04, 34.6MB/s] 16%|█▌        | 25.1M/154M [00:00<00:03, 37.1MB/s] 19%|█▉        | 29.3M/154M [00:00<00:03, 39.0MB/s] 22%|██▏       | 33.6M/154M [00:00<00:03, 40.6MB/s] 25%|██▍       | 37.9M/154M [00:01<00:02, 41.7MB/s] 27%|██▋       | 42.2M/154M [00:01<00:02, 42.6MB/s] 30%|███       | 46.4M/154M [00:01<00:02, 40.7MB/s] 33%|███▎      | 50.4M/154M [00:01<00:02, 37.4MB/s] 35%|███▌      | 54.1M/154M [00:01<00:02, 35.6MB/s] 37%|███▋      | 57.6M/154M [00:01<00:02, 35.0MB/s] 39%|███▉      | 61.0M/154M [00:01<00:02, 35.2MB/s] 42%|████▏     | 64.4M/154M [00:01<00:02, 35.3MB/s] 44%|████▍     | 67.8M/154M [00:01<00:02, 35.3MB/s] 46%|████▌     | 71.2M/154M [00:02<00:02, 35.4MB/s] 48%|████▊     | 74.6M/154M [00:02<00:02, 35.4MB/s] 50%|█████     | 78.0M/154M [00:02<00:02, 35.4MB/s] 53%|█████▎    | 81.4M/154M [00:02<00:02, 31.1MB/s] 55%|█████▍    | 84.4M/154M [00:02<00:05, 13.9MB/s] 56%|█████▌    | 86.7M/154M [00:03<00:05, 12.7MB/s] 57%|█████▋    | 88.6M/154M [00:03<00:05, 12.1MB/s] 58%|█████▊    | 90.2M/154M [00:03<00:05, 12.0MB/s] 59%|█████▉    | 91.7M/154M [00:03<00:05, 11.9MB/s] 60%|██████    | 93.1M/154M [00:03<00:05, 12.0MB/s] 61%|██████    | 94.4M/154M [00:03<00:05, 11.9MB/s] 62%|██████▏   | 95.6M/154M [00:04<00:05, 12.2MB/s] 63%|██████▎   | 96.9M/154M [00:04<00:04, 12.4MB/s] 64%|██████▎   | 98.2M/154M [00:04<00:04, 12.6MB/s] 64%|██████▍   | 99.5M/154M [00:04<00:04, 12.8MB/s] 65%|██████▌   | 101M/154M [00:04<00:04, 12.8MB/s]  66%|██████▌   | 102M/154M [00:04<00:04, 13.1MB/s] 67%|██████▋   | 104M/154M [00:04<00:03, 13.7MB/s] 68%|██████▊   | 105M/154M [00:04<00:03, 14.2MB/s] 69%|██████▉   | 107M/154M [00:04<00:03, 14.6MB/s] 70%|██████▉   | 108M/154M [00:04<00:03, 14.9MB/s] 71%|███████   | 110M/154M [00:05<00:03, 15.1MB/s] 72%|███████▏  | 111M/154M [00:05<00:02, 15.3MB/s] 73%|███████▎  | 113M/154M [00:05<00:02, 15.5MB/s] 74%|███████▍  | 114M/154M [00:05<00:02, 16.2MB/s] 75%|███████▌  | 116M/154M [00:05<00:02, 16.7MB/s] 76%|███████▋  | 118M/154M [00:05<00:02, 17.0MB/s] 77%|███████▋  | 120M/154M [00:05<00:02, 17.2MB/s] 79%|███████▊  | 121M/154M [00:05<00:01, 17.4MB/s] 80%|███████▉  | 123M/154M [00:05<00:01, 17.6MB/s] 81%|████████  | 125M/154M [00:05<00:01, 17.6MB/s] 82%|████████▏ | 127M/154M [00:06<00:01, 18.0MB/s] 83%|████████▎ | 129M/154M [00:06<00:01, 18.6MB/s] 85%|████████▍ | 131M/154M [00:06<00:01, 19.1MB/s] 86%|████████▌ | 133M/154M [00:06<00:01, 19.4MB/s] 87%|████████▋ | 134M/154M [00:06<00:01, 19.6MB/s] 88%|████████▊ | 136M/154M [00:06<00:00, 19.9MB/s] 90%|████████▉ | 139M/154M [00:06<00:00, 20.6MB/s] 91%|█████████ | 141M/154M [00:06<00:00, 21.1MB/s] 93%|█████████▎| 143M/154M [00:06<00:00, 21.5MB/s] 94%|█████████▍| 145M/154M [00:07<00:00, 21.7MB/s] 95%|█████████▌| 147M/154M [00:07<00:00, 21.9MB/s] 97%|█████████▋| 149M/154M [00:07<00:00, 22.0MB/s] 98%|█████████▊| 152M/154M [00:07<00:00, 22.1MB/s]100%|█████████▉| 154M/154M [00:07<00:00, 22.1MB/s]                                                  2023-10-25 22:53:03,711 INFO Download rate 20.7M/s
2023-10-25 22:53:03,711 INFO Download rate 20.7M/s
2023-10-25 22:53:03,761 INFO Welcome to the CDS
2023-10-25 22:53:03,761 INFO Welcome to the CDS
2023-10-25 22:53:03,761 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:53:03,761 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:53:03,987 INFO Request is queued
2023-10-25 22:53:03,987 INFO Request is queued
2023-10-25 22:53:05,008 INFO Request is running
2023-10-25 22:53:05,008 INFO Request is running
2023-10-25 22:53:12,198 INFO Request is completed
2023-10-25 22:53:12,198 INFO Request is completed
2023-10-25 22:53:12,199 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data9/adaptor.mars.internal-1698267184.1754882-26268-11-ff4e1350-40fa-4121-ac0b-a20e7d367330.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-71290f91f0f872d8f6ac617f8d3c1929e15c330abca2fbd751e1fb193409a13a.cache.tmp (154.5M)
2023-10-25 22:53:12,199 INFO Downloading https://download-0000-clone.copernicus-climate.eu/cache-compute-0000/cache/data9/adaptor.mars.internal-1698267184.1754882-26268-11-ff4e1350-40fa-4121-ac0b-a20e7d367330.grib to /tmp/34662429/climetlab-lpoulain/cds-retriever-71290f91f0f872d8f6ac617f8d3c1929e15c330abca2fbd751e1fb193409a13a.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  1%|          | 899k/154M [00:00<00:17, 9.05MB/s]  2%|▏         | 2.80M/154M [00:00<00:10, 15.3MB/s]  3%|▎         | 4.96M/154M [00:00<00:08, 18.5MB/s]  5%|▍         | 7.37M/154M [00:00<00:07, 20.9MB/s]  6%|▋         | 9.73M/154M [00:00<00:06, 22.1MB/s]  8%|▊         | 12.3M/154M [00:00<00:06, 23.5MB/s] 10%|▉         | 14.9M/154M [00:00<00:05, 24.5MB/s] 11%|█▏        | 17.5M/154M [00:00<00:05, 25.2MB/s] 13%|█▎        | 20.1M/154M [00:00<00:05, 25.7MB/s] 15%|█▍        | 22.5M/154M [00:01<00:05, 25.6MB/s] 16%|█▌        | 25.0M/154M [00:01<00:05, 23.1MB/s] 18%|█▊        | 27.2M/154M [00:01<00:06, 22.2MB/s] 19%|█▉        | 29.4M/154M [00:01<00:06, 21.3MB/s] 20%|██        | 31.4M/154M [00:01<00:06, 21.1MB/s] 22%|██▏       | 33.5M/154M [00:01<00:06, 20.6MB/s] 23%|██▎       | 35.6M/154M [00:01<00:05, 21.0MB/s] 24%|██▍       | 37.8M/154M [00:01<00:05, 21.4MB/s] 26%|██▌       | 39.8M/154M [00:01<00:05, 21.2MB/s] 27%|██▋       | 42.0M/154M [00:02<00:05, 21.6MB/s] 29%|██▊       | 44.2M/154M [00:02<00:05, 21.8MB/s] 30%|██▉       | 46.3M/154M [00:02<00:05, 22.0MB/s] 31%|███▏      | 48.5M/154M [00:02<00:04, 22.3MB/s] 33%|███▎      | 50.7M/154M [00:02<00:04, 22.2MB/s] 34%|███▍      | 52.8M/154M [00:02<00:04, 22.2MB/s] 36%|███▌      | 54.9M/154M [00:02<00:04, 22.2MB/s] 37%|███▋      | 57.1M/154M [00:02<00:04, 22.2MB/s] 38%|███▊      | 59.4M/154M [00:02<00:04, 22.8MB/s] 40%|████      | 61.8M/154M [00:02<00:04, 23.3MB/s] 42%|████▏     | 64.2M/154M [00:03<00:03, 23.7MB/s] 43%|████▎     | 66.5M/154M [00:03<00:04, 21.1MB/s] 44%|████▍     | 68.5M/154M [00:03<00:06, 13.2MB/s] 45%|████▌     | 70.2M/154M [00:03<00:09, 9.72MB/s] 46%|████▋     | 71.5M/154M [00:04<00:10, 8.69MB/s] 47%|████▋     | 72.6M/154M [00:04<00:10, 8.31MB/s] 48%|████▊     | 73.5M/154M [00:04<00:10, 8.01MB/s] 48%|████▊     | 74.4M/154M [00:04<00:10, 7.97MB/s] 49%|████▊     | 75.2M/154M [00:04<00:10, 7.95MB/s] 49%|████▉     | 76.0M/154M [00:04<00:10, 8.05MB/s] 50%|████▉     | 76.9M/154M [00:04<00:09, 8.27MB/s] 50%|█████     | 77.8M/154M [00:04<00:09, 8.45MB/s] 51%|█████     | 78.6M/154M [00:04<00:09, 8.59MB/s] 52%|█████▏    | 79.6M/154M [00:05<00:08, 8.93MB/s] 52%|█████▏    | 80.6M/154M [00:05<00:08, 9.33MB/s] 53%|█████▎    | 81.6M/154M [00:05<00:07, 9.65MB/s] 53%|█████▎    | 82.6M/154M [00:05<00:07, 9.87MB/s] 54%|█████▍    | 83.7M/154M [00:05<00:07, 10.1MB/s] 55%|█████▍    | 84.8M/154M [00:05<00:06, 10.6MB/s] 56%|█████▌    | 86.0M/154M [00:05<00:06, 11.0MB/s] 56%|█████▋    | 87.1M/154M [00:05<00:06, 11.2MB/s] 57%|█████▋    | 88.3M/154M [00:05<00:06, 11.4MB/s] 58%|█████▊    | 89.5M/154M [00:05<00:05, 11.9MB/s] 59%|█████▉    | 90.8M/154M [00:06<00:05, 12.3MB/s] 60%|█████▉    | 92.1M/154M [00:06<00:05, 12.7MB/s] 60%|██████    | 93.5M/154M [00:06<00:04, 12.9MB/s] 61%|██████▏   | 94.8M/154M [00:06<00:04, 13.0MB/s] 62%|██████▏   | 96.1M/154M [00:06<00:04, 13.2MB/s] 63%|██████▎   | 97.5M/154M [00:06<00:04, 13.7MB/s] 64%|██████▍   | 99.0M/154M [00:06<00:04, 14.2MB/s] 65%|██████▌   | 101M/154M [00:06<00:03, 14.6MB/s]  66%|██████▌   | 102M/154M [00:06<00:03, 14.9MB/s] 67%|██████▋   | 104M/154M [00:07<00:03, 15.1MB/s] 68%|██████▊   | 105M/154M [00:07<00:03, 15.3MB/s] 69%|██████▉   | 107M/154M [00:07<00:03, 15.4MB/s] 70%|███████   | 108M/154M [00:07<00:03, 16.1MB/s] 71%|███████   | 110M/154M [00:07<00:02, 16.6MB/s] 72%|███████▏  | 112M/154M [00:07<00:02, 17.0MB/s] 73%|███████▎  | 114M/154M [00:07<00:02, 17.3MB/s] 75%|███████▍  | 115M/154M [00:07<00:02, 17.5MB/s] 76%|███████▌  | 117M/154M [00:07<00:02, 17.6MB/s] 77%|███████▋  | 119M/154M [00:07<00:02, 17.8MB/s] 78%|███████▊  | 120M/154M [00:08<00:01, 17.9MB/s] 79%|███████▉  | 122M/154M [00:08<00:01, 18.5MB/s] 81%|████████  | 124M/154M [00:08<00:01, 19.0MB/s] 82%|████████▏ | 126M/154M [00:08<00:01, 19.3MB/s] 83%|████████▎ | 128M/154M [00:08<00:01, 19.6MB/s] 84%|████████▍ | 130M/154M [00:08<00:01, 19.8MB/s] 86%|████████▌ | 132M/154M [00:08<00:01, 20.4MB/s] 87%|████████▋ | 135M/154M [00:08<00:00, 21.0MB/s] 89%|████████▊ | 137M/154M [00:08<00:00, 21.4MB/s] 90%|████████▉ | 139M/154M [00:08<00:00, 21.7MB/s] 91%|█████████▏| 141M/154M [00:09<00:00, 21.9MB/s] 93%|█████████▎| 143M/154M [00:09<00:00, 22.0MB/s] 94%|█████████▍| 145M/154M [00:09<00:00, 22.2MB/s] 96%|█████████▌| 148M/154M [00:09<00:00, 22.2MB/s] 97%|█████████▋| 150M/154M [00:09<00:00, 22.2MB/s] 98%|█████████▊| 152M/154M [00:09<00:00, 22.2MB/s]100%|█████████▉| 154M/154M [00:09<00:00, 22.8MB/s]                                                  2023-10-25 22:53:21,881 INFO Download rate 16M/s
2023-10-25 22:53:21,881 INFO Download rate 16M/s
2023-10-25 22:53:27,376 INFO Creating forcing variables: 5 seconds.
2023-10-25 22:53:30,223 INFO Converting GRIB to xarray: 2 seconds.
2023-10-25 22:53:30,546 INFO Reindexing: 0.3 second.
2023-10-25 22:53:30,563 INFO Creating training data: 49 seconds.
2023-10-25 22:53:31,119 INFO Extracting input targets: 0.5 second.
2023-10-25 22:53:31,119 INFO Creating input data (total): 49 seconds.
2023-10-25 22:53:31,446 INFO Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Interpreter Host CUDA
2023-10-25 22:53:31,446 INFO Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
2023-10-25 22:53:31,446 INFO Unable to initialize backend 'plugin': xla_extension has no attributes named get_plugin_device_client. Compile TensorFlow with //tensorflow/compiler/xla/python:enable_plugin_device set to true (defaults to false) to enable this.
2023-10-25 22:54:50.105611: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 1s:

  %pad.149 = bf16[3114720,8]{1,0} pad(bf16[3114720,4]{1,0} %constant.365, bf16[] %constant.768), padding=0_0x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/mesh2grid_gnn/_embed/mesh2grid_gnn/sequential/encoder_edges_mesh2grid_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:54:59.402055: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 10.296527752s
Constant folding an instruction is taking > 1s:

  %pad.149 = bf16[3114720,8]{1,0} pad(bf16[3114720,4]{1,0} %constant.365, bf16[] %constant.768), padding=0_0x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/mesh2grid_gnn/_embed/mesh2grid_gnn/sequential/encoder_edges_mesh2grid_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:55:01.828919: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 2s:

  %pad.1 = bf16[1618752,8]{1,0} pad(bf16[1618745,4]{1,0} %constant.374, bf16[] %constant.687), padding=0_7x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/grid2mesh_gnn/_embed/grid2mesh_gnn/sequential/encoder_edges_grid2mesh_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:55:05.250112: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 5.421248185s
Constant folding an instruction is taking > 2s:

  %pad.1 = bf16[1618752,8]{1,0} pad(bf16[1618745,4]{1,0} %constant.374, bf16[] %constant.687), padding=0_7x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/grid2mesh_gnn/_embed/grid2mesh_gnn/sequential/encoder_edges_grid2mesh_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:55:18,459 INFO Doing full rollout prediction in JAX: 1 minute 47 seconds.
2023-10-25 22:55:18,459 INFO Converting output xarray to GRIB and saving
2023-10-25 22:55:33,299 INFO Saving output data: 14 seconds.
2023-10-25 22:55:33,307 INFO Total time: 2 minutes 54 seconds.

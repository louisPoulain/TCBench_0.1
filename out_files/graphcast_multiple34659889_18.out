2023-10-25 22:43:15,124 INFO Writing results to /scratch/lpoulain/graphcast/graphcast_d_20191126_t_1200_{step}h.grib.
/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/gribapi/__init__.py:23: UserWarning: ecCodes 2.31.0 or higher is recommended. You are running version 2.30.0
  warnings.warn(
2023-10-25 22:43:15,805 INFO Model description: 
GraphCast model at 0.25deg resolution, with 13 pressure levels. This model is
trained on ERA5 data from 1979 to 2017, and fine-tuned on HRES-fc0 data from
2016 to 2021 and can be causally evaluated on 2022 and later years. This model
does not take `total_precipitation_6hr` as inputs and can make predictions in an
operational setting (i.e., initialised from HRES-fc0).

2023-10-25 22:43:15,806 INFO Model license: 
The model weights are licensed under the Creative Commons
Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0). You
may obtain a copy of the License at:
https://creativecommons.org/licenses/by-nc-sa/4.0/.
The weights were trained on ERA5 data, see README for attribution statement.

2023-10-25 22:43:15,806 INFO Loading params/GraphCast_operational - ERA5-HRES 1979-2021 - resolution 0.25 - pressure levels 13 - mesh 2to6 - precipitation output only.npz: 0.7 second.
2023-10-25 22:43:15,806 INFO Building model: 0.7 second.
2023-10-25 22:43:15,806 INFO Loading surface fields from CDS
2023-10-25 22:43:16,538 INFO Welcome to the CDS
2023-10-25 22:43:16,538 INFO Welcome to the CDS
2023-10-25 22:43:16,539 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:43:16,539 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:43:16,589 INFO Request is queued
2023-10-25 22:43:16,589 INFO Request is queued
2023-10-25 22:43:17,610 INFO Request is running
2023-10-25 22:43:17,610 INFO Request is running
2023-10-25 22:43:19,135 INFO Request is completed
2023-10-25 22:43:19,135 INFO Request is completed
2023-10-25 22:43:19,135 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data6/adaptor.mars.internal-1698266596.853636-24707-1-804bdf63-47e0-450e-a9b6-a3539e97fe30.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-fc9f41a31c40d06a274cdc676487b2011790c34fdd7a3df13dcd992d897d8cfc.cache.tmp (15.8M)
2023-10-25 22:43:19,135 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data6/adaptor.mars.internal-1698266596.853636-24707-1-804bdf63-47e0-450e-a9b6-a3539e97fe30.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-fc9f41a31c40d06a274cdc676487b2011790c34fdd7a3df13dcd992d897d8cfc.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s]  8%|▊         | 1.21M/15.8M [00:00<00:01, 12.3MB/s] 15%|█▌        | 2.39M/15.8M [00:00<00:01, 8.63MB/s] 58%|█████▊    | 9.12M/15.8M [00:00<00:00, 31.4MB/s]                                                    2023-10-25 22:43:19,718 INFO Download rate 27.2M/s
2023-10-25 22:43:19,718 INFO Download rate 27.2M/s
2023-10-25 22:43:19,783 INFO Welcome to the CDS
2023-10-25 22:43:19,783 INFO Welcome to the CDS
2023-10-25 22:43:19,783 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:43:19,783 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:43:19,822 INFO Request is queued
2023-10-25 22:43:19,822 INFO Request is queued
2023-10-25 22:43:20,843 INFO Request is running
2023-10-25 22:43:20,843 INFO Request is running
2023-10-25 22:43:22,364 INFO Request is completed
2023-10-25 22:43:22,364 INFO Request is completed
2023-10-25 22:43:22,364 INFO Downloading https://download-0005-clone.copernicus-climate.eu/cache-compute-0005/cache/data1/adaptor.mars.internal-1698266600.3726935-26221-9-6290016c-8ca8-4ee3-92ff-06fc5a7afff5.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-825b3e5253fa26742568fbef9bc546744df7ce203a2efd7f58b0cf79fdff7c7d.cache.tmp (15.8M)
2023-10-25 22:43:22,364 INFO Downloading https://download-0005-clone.copernicus-climate.eu/cache-compute-0005/cache/data1/adaptor.mars.internal-1698266600.3726935-26221-9-6290016c-8ca8-4ee3-92ff-06fc5a7afff5.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-825b3e5253fa26742568fbef9bc546744df7ce203a2efd7f58b0cf79fdff7c7d.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s]  3%|▎         | 468k/15.8M [00:00<00:03, 4.44MB/s] 26%|██▌       | 4.09M/15.8M [00:00<00:00, 23.6MB/s] 60%|██████    | 9.52M/15.8M [00:00<00:00, 38.6MB/s] 90%|█████████ | 14.3M/15.8M [00:00<00:00, 42.8MB/s]                                                    2023-10-25 22:43:22,948 INFO Download rate 28.5M/s
2023-10-25 22:43:22,948 INFO Download rate 28.5M/s
2023-10-25 22:43:22,975 INFO Loading pressure fields from CDS
2023-10-25 22:43:22,994 INFO Welcome to the CDS
2023-10-25 22:43:22,994 INFO Welcome to the CDS
2023-10-25 22:43:22,994 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:43:22,994 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:43:23,197 INFO Request is queued
2023-10-25 22:43:23,197 INFO Request is queued
2023-10-25 22:43:25,739 INFO Request is running
2023-10-25 22:43:25,739 INFO Request is running
2023-10-25 22:43:31,410 INFO Request is completed
2023-10-25 22:43:31,410 INFO Request is completed
2023-10-25 22:43:31,410 INFO Downloading https://download-0009-clone.copernicus-climate.eu/cache-compute-0009/cache/data4/adaptor.mars.internal-1698266604.401876-16057-23-5c0f2417-7c56-447c-b34b-98fdad609732.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-23067436f2c2ae75c85a5abfca9dbab81af23925c09b2607b4765cfb7448f3e7.cache.tmp (154.5M)
2023-10-25 22:43:31,410 INFO Downloading https://download-0009-clone.copernicus-climate.eu/cache-compute-0009/cache/data4/adaptor.mars.internal-1698266604.401876-16057-23-5c0f2417-7c56-447c-b34b-98fdad609732.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-23067436f2c2ae75c85a5abfca9dbab81af23925c09b2607b4765cfb7448f3e7.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  0%|          | 705k/154M [00:00<00:23, 6.93MB/s]  4%|▍         | 6.45M/154M [00:00<00:04, 37.8MB/s]  8%|▊         | 13.1M/154M [00:00<00:02, 52.3MB/s] 13%|█▎        | 19.9M/154M [00:00<00:02, 59.8MB/s] 17%|█▋        | 26.7M/154M [00:00<00:02, 64.0MB/s] 22%|██▏       | 33.6M/154M [00:00<00:01, 66.7MB/s] 26%|██▌       | 40.4M/154M [00:00<00:01, 68.4MB/s] 31%|███       | 47.3M/154M [00:00<00:01, 69.5MB/s] 35%|███▌      | 54.1M/154M [00:00<00:01, 70.2MB/s] 39%|███▉      | 61.0M/154M [00:01<00:01, 70.7MB/s] 44%|████▍     | 67.9M/154M [00:01<00:01, 71.1MB/s] 48%|████▊     | 74.7M/154M [00:01<00:01, 71.4MB/s] 53%|█████▎    | 81.6M/154M [00:01<00:01, 71.5MB/s] 57%|█████▋    | 88.4M/154M [00:01<00:00, 71.5MB/s] 62%|██████▏   | 95.3M/154M [00:01<00:00, 71.6MB/s] 66%|██████▌   | 102M/154M [00:01<00:00, 71.8MB/s]  71%|███████   | 109M/154M [00:01<00:00, 71.5MB/s] 75%|███████▍  | 116M/154M [00:01<00:00, 71.5MB/s] 79%|███████▉  | 123M/154M [00:01<00:00, 71.5MB/s] 84%|████████▍ | 129M/154M [00:02<00:00, 71.5MB/s] 88%|████████▊ | 136M/154M [00:02<00:00, 71.7MB/s] 93%|█████████▎| 143M/154M [00:02<00:00, 71.8MB/s] 97%|█████████▋| 150M/154M [00:02<00:00, 71.9MB/s]                                                  2023-10-25 22:43:33,879 INFO Download rate 62.6M/s
2023-10-25 22:43:33,879 INFO Download rate 62.6M/s
2023-10-25 22:43:33,927 INFO Welcome to the CDS
2023-10-25 22:43:33,927 INFO Welcome to the CDS
2023-10-25 22:43:33,927 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:43:33,927 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:43:33,963 INFO Request is queued
2023-10-25 22:43:33,963 INFO Request is queued
2023-10-25 22:43:36,505 INFO Request is running
2023-10-25 22:43:36,505 INFO Request is running
2023-10-25 22:43:42,175 INFO Request is completed
2023-10-25 22:43:42,175 INFO Request is completed
2023-10-25 22:43:42,175 INFO Downloading https://download-0005-clone.copernicus-climate.eu/cache-compute-0005/cache/data4/adaptor.mars.internal-1698266615.8947053-27298-5-723668ac-863a-4a0f-9f32-e9420ec4b7aa.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-665d47efe566ab96a10f5cdef56e7f2baea695ab4b2f9e47e51110366d71c278.cache.tmp (154.5M)
2023-10-25 22:43:42,175 INFO Downloading https://download-0005-clone.copernicus-climate.eu/cache-compute-0005/cache/data4/adaptor.mars.internal-1698266615.8947053-27298-5-723668ac-863a-4a0f-9f32-e9420ec4b7aa.grib to /tmp/34662425/climetlab-lpoulain/cds-retriever-665d47efe566ab96a10f5cdef56e7f2baea695ab4b2f9e47e51110366d71c278.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  1%|          | 837k/154M [00:00<00:19, 8.24MB/s]  2%|▏         | 3.85M/154M [00:00<00:07, 21.2MB/s]  4%|▍         | 6.66M/154M [00:00<00:06, 24.3MB/s]  6%|▌         | 8.97M/154M [00:00<00:06, 22.0MB/s]  7%|▋         | 11.1M/154M [00:00<00:08, 18.6MB/s]  8%|▊         | 12.9M/154M [00:00<00:09, 16.1MB/s]  9%|▉         | 14.5M/154M [00:00<00:10, 14.2MB/s] 10%|█         | 16.0M/154M [00:01<00:11, 13.1MB/s] 11%|█         | 17.3M/154M [00:01<00:11, 13.0MB/s] 12%|█▏        | 18.5M/154M [00:01<00:11, 12.9MB/s] 13%|█▎        | 19.8M/154M [00:01<00:11, 12.7MB/s] 14%|█▎        | 21.0M/154M [00:01<00:11, 12.0MB/s] 14%|█▍        | 22.1M/154M [00:01<00:12, 11.0MB/s] 15%|█▌        | 23.2M/154M [00:01<00:12, 10.8MB/s] 16%|█▌        | 24.2M/154M [00:01<00:13, 10.3MB/s] 16%|█▋        | 25.2M/154M [00:01<00:13, 10.2MB/s] 17%|█▋        | 26.2M/154M [00:02<00:13, 10.1MB/s] 18%|█▊        | 27.2M/154M [00:02<00:13, 10.0MB/s] 18%|█▊        | 28.2M/154M [00:02<00:12, 10.2MB/s] 19%|█▉        | 29.3M/154M [00:02<00:12, 10.4MB/s] 20%|█▉        | 30.5M/154M [00:02<00:12, 10.6MB/s] 20%|██        | 31.6M/154M [00:02<00:11, 10.8MB/s] 21%|██        | 32.7M/154M [00:02<00:11, 10.9MB/s] 22%|██▏       | 33.8M/154M [00:02<00:11, 11.0MB/s] 23%|██▎       | 35.0M/154M [00:02<00:11, 11.4MB/s] 23%|██▎       | 36.2M/154M [00:03<00:11, 11.3MB/s] 24%|██▍       | 37.2M/154M [00:03<00:11, 10.4MB/s] 25%|██▍       | 38.2M/154M [00:03<00:11, 10.2MB/s] 25%|██▌       | 39.2M/154M [00:03<00:12, 9.79MB/s] 26%|██▌       | 40.2M/154M [00:03<00:12, 9.69MB/s] 27%|██▋       | 41.1M/154M [00:03<00:12, 9.74MB/s] 27%|██▋       | 42.1M/154M [00:03<00:12, 9.78MB/s] 28%|██▊       | 43.1M/154M [00:03<00:11, 9.81MB/s] 29%|██▊       | 44.2M/154M [00:03<00:11, 9.97MB/s] 29%|██▉       | 45.2M/154M [00:03<00:11, 10.2MB/s] 30%|███       | 46.4M/154M [00:04<00:10, 10.5MB/s] 31%|███       | 47.5M/154M [00:04<00:10, 10.7MB/s] 31%|███▏      | 48.6M/154M [00:04<00:10, 10.8MB/s] 32%|███▏      | 49.7M/154M [00:04<00:10, 10.9MB/s] 33%|███▎      | 50.9M/154M [00:04<00:09, 11.2MB/s] 34%|███▎      | 52.1M/154M [00:04<00:09, 11.6MB/s] 35%|███▍      | 53.4M/154M [00:04<00:08, 11.8MB/s] 35%|███▌      | 54.6M/154M [00:04<00:08, 12.0MB/s] 36%|███▌      | 55.9M/154M [00:04<00:08, 12.3MB/s] 37%|███▋      | 57.2M/154M [00:05<00:08, 12.5MB/s] 38%|███▊      | 58.5M/154M [00:05<00:07, 12.7MB/s] 39%|███▊      | 59.8M/154M [00:05<00:07, 12.9MB/s] 40%|███▉      | 61.2M/154M [00:05<00:07, 13.1MB/s] 41%|████      | 62.6M/154M [00:05<00:07, 13.3MB/s] 41%|████▏     | 64.0M/154M [00:05<00:06, 13.7MB/s] 42%|████▏     | 65.5M/154M [00:05<00:06, 13.7MB/s] 43%|████▎     | 67.0M/154M [00:05<00:06, 14.1MB/s] 44%|████▍     | 68.5M/154M [00:05<00:06, 14.3MB/s] 45%|████▌     | 70.0M/154M [00:05<00:06, 14.4MB/s] 46%|████▋     | 71.5M/154M [00:06<00:05, 14.5MB/s] 47%|████▋     | 73.0M/154M [00:06<00:05, 14.7MB/s] 48%|████▊     | 74.6M/154M [00:06<00:05, 15.0MB/s] 49%|████▉     | 76.3M/154M [00:06<00:05, 15.5MB/s] 50%|█████     | 77.9M/154M [00:06<00:05, 15.9MB/s] 52%|█████▏    | 79.6M/154M [00:06<00:04, 16.1MB/s] 53%|█████▎    | 81.3M/154M [00:06<00:04, 16.3MB/s] 54%|█████▎    | 83.0M/154M [00:06<00:04, 16.4MB/s] 55%|█████▍    | 84.6M/154M [00:06<00:04, 16.5MB/s] 56%|█████▌    | 86.3M/154M [00:07<00:04, 16.7MB/s] 57%|█████▋    | 88.2M/154M [00:07<00:04, 17.3MB/s] 58%|█████▊    | 90.0M/154M [00:07<00:03, 17.7MB/s] 59%|█████▉    | 91.9M/154M [00:07<00:03, 17.9MB/s] 61%|██████    | 93.8M/154M [00:07<00:03, 18.1MB/s] 62%|██████▏   | 95.6M/154M [00:07<00:03, 18.3MB/s] 63%|██████▎   | 97.3M/154M [00:07<00:03, 18.2MB/s] 64%|██████▍   | 99.1M/154M [00:07<00:03, 18.3MB/s] 65%|██████▌   | 101M/154M [00:07<00:03, 18.5MB/s]  66%|██████▋   | 103M/154M [00:07<00:02, 18.5MB/s] 68%|██████▊   | 105M/154M [00:08<00:02, 19.1MB/s] 69%|██████▉   | 107M/154M [00:08<00:02, 19.4MB/s] 70%|███████   | 109M/154M [00:08<00:02, 19.8MB/s] 72%|███████▏  | 111M/154M [00:08<00:02, 20.1MB/s] 73%|███████▎  | 113M/154M [00:08<00:02, 20.1MB/s] 74%|███████▍  | 114M/154M [00:08<00:02, 20.1MB/s] 76%|███████▌  | 117M/154M [00:08<00:01, 20.7MB/s] 77%|███████▋  | 119M/154M [00:08<00:01, 21.2MB/s] 78%|███████▊  | 121M/154M [00:08<00:01, 21.6MB/s] 80%|███████▉  | 123M/154M [00:08<00:01, 21.8MB/s] 81%|████████  | 125M/154M [00:09<00:01, 21.8MB/s] 83%|████████▎ | 127M/154M [00:09<00:01, 21.9MB/s] 84%|████████▍ | 130M/154M [00:09<00:01, 22.0MB/s] 85%|████████▌ | 132M/154M [00:09<00:01, 22.1MB/s] 87%|████████▋ | 134M/154M [00:09<00:00, 22.1MB/s] 88%|████████▊ | 136M/154M [00:09<00:00, 22.2MB/s] 90%|████████▉ | 139M/154M [00:09<00:00, 22.2MB/s] 91%|█████████▏| 141M/154M [00:09<00:00, 22.8MB/s] 93%|█████████▎| 143M/154M [00:09<00:00, 23.2MB/s] 94%|█████████▍| 146M/154M [00:10<00:00, 23.5MB/s] 96%|█████████▌| 148M/154M [00:10<00:00, 23.7MB/s] 97%|█████████▋| 150M/154M [00:10<00:00, 23.1MB/s] 99%|█████████▉| 153M/154M [00:10<00:00, 21.5MB/s]                                                  2023-10-25 22:43:52,666 INFO Download rate 14.7M/s
2023-10-25 22:43:52,666 INFO Download rate 14.7M/s
2023-10-25 22:43:59,736 INFO Creating forcing variables: 6 seconds.
2023-10-25 22:44:02,865 INFO Converting GRIB to xarray: 3 seconds.
2023-10-25 22:44:03,498 INFO Reindexing: 0.6 second.
2023-10-25 22:44:03,519 INFO Creating training data: 47 seconds.
2023-10-25 22:44:04,707 INFO Extracting input targets: 1 second.
2023-10-25 22:44:04,707 INFO Creating input data (total): 48 seconds.
2023-10-25 22:44:05,022 INFO Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Host Interpreter CUDA
2023-10-25 22:44:05,023 INFO Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
2023-10-25 22:44:05,023 INFO Unable to initialize backend 'plugin': xla_extension has no attributes named get_plugin_device_client. Compile TensorFlow with //tensorflow/compiler/xla/python:enable_plugin_device set to true (defaults to false) to enable this.
2023-10-25 22:45:24.044640: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 1s:

  %pad.149 = bf16[3114720,8]{1,0} pad(bf16[3114720,4]{1,0} %constant.365, bf16[] %constant.768), padding=0_0x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/mesh2grid_gnn/_embed/mesh2grid_gnn/sequential/encoder_edges_mesh2grid_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:45:33.193629: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 10.149070339s
Constant folding an instruction is taking > 1s:

  %pad.149 = bf16[3114720,8]{1,0} pad(bf16[3114720,4]{1,0} %constant.365, bf16[] %constant.768), padding=0_0x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/mesh2grid_gnn/_embed/mesh2grid_gnn/sequential/encoder_edges_mesh2grid_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:45:35.603389: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 2s:

  %pad.1 = bf16[1618752,8]{1,0} pad(bf16[1618745,4]{1,0} %constant.374, bf16[] %constant.687), padding=0_7x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/grid2mesh_gnn/_embed/grid2mesh_gnn/sequential/encoder_edges_grid2mesh_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:45:38.860698: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 5.257369092s
Constant folding an instruction is taking > 2s:

  %pad.1 = bf16[1618752,8]{1,0} pad(bf16[1618745,4]{1,0} %constant.374, bf16[] %constant.687), padding=0_7x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/grid2mesh_gnn/_embed/grid2mesh_gnn/sequential/encoder_edges_grid2mesh_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:45:55,041 INFO Doing full rollout prediction in JAX: 1 minute 50 seconds.
2023-10-25 22:45:55,041 INFO Converting output xarray to GRIB and saving
2023-10-25 22:46:26,933 INFO Saving output data: 31 seconds.
2023-10-25 22:46:26,951 INFO Total time: 3 minutes 13 seconds.

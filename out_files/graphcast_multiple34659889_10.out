2023-10-25 22:28:55,722 INFO Writing results to /scratch/lpoulain/graphcast/graphcast_d_20191124_t_1200_{step}h.grib.
/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/gribapi/__init__.py:23: UserWarning: ecCodes 2.31.0 or higher is recommended. You are running version 2.30.0
  warnings.warn(
2023-10-25 22:28:56,429 INFO Model description: 
GraphCast model at 0.25deg resolution, with 13 pressure levels. This model is
trained on ERA5 data from 1979 to 2017, and fine-tuned on HRES-fc0 data from
2016 to 2021 and can be causally evaluated on 2022 and later years. This model
does not take `total_precipitation_6hr` as inputs and can make predictions in an
operational setting (i.e., initialised from HRES-fc0).

2023-10-25 22:28:56,429 INFO Model license: 
The model weights are licensed under the Creative Commons
Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0). You
may obtain a copy of the License at:
https://creativecommons.org/licenses/by-nc-sa/4.0/.
The weights were trained on ERA5 data, see README for attribution statement.

2023-10-25 22:28:56,430 INFO Loading params/GraphCast_operational - ERA5-HRES 1979-2021 - resolution 0.25 - pressure levels 13 - mesh 2to6 - precipitation output only.npz: 0.7 second.
2023-10-25 22:28:56,430 INFO Building model: 0.7 second.
2023-10-25 22:28:56,430 INFO Loading surface fields from CDS
2023-10-25 22:28:57,185 INFO Welcome to the CDS
2023-10-25 22:28:57,185 INFO Welcome to the CDS
2023-10-25 22:28:57,186 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:28:57,186 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:28:57,278 INFO Request is completed
2023-10-25 22:28:57,278 INFO Request is completed
2023-10-25 22:28:57,278 INFO Downloading https://download-0006-clone.copernicus-climate.eu/cache-compute-0006/cache/data7/adaptor.mars.internal-1698239329.120311-25341-7-840bee38-327d-48cd-992d-89637853c3f4.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-ed52075ce0047d515e9d8d1d8d99cca3c1c29e91cb700f1b49b279c9f23a9936.cache.tmp (15.8M)
2023-10-25 22:28:57,278 INFO Downloading https://download-0006-clone.copernicus-climate.eu/cache-compute-0006/cache/data7/adaptor.mars.internal-1698239329.120311-25341-7-840bee38-327d-48cd-992d-89637853c3f4.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-ed52075ce0047d515e9d8d1d8d99cca3c1c29e91cb700f1b49b279c9f23a9936.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s] 12%|█▏        | 1.94M/15.8M [00:00<00:00, 20.3MB/s] 55%|█████▍    | 8.67M/15.8M [00:00<00:00, 49.9MB/s] 98%|█████████▊| 15.5M/15.8M [00:00<00:00, 59.8MB/s]                                                    2023-10-25 22:28:57,679 INFO Download rate 39.5M/s
2023-10-25 22:28:57,679 INFO Download rate 39.5M/s
2023-10-25 22:28:57,750 INFO Welcome to the CDS
2023-10-25 22:28:57,750 INFO Welcome to the CDS
2023-10-25 22:28:57,750 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:28:57,750 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-25 22:28:57,818 INFO Request is queued
2023-10-25 22:28:57,818 INFO Request is queued
2023-10-25 22:29:00,366 INFO Request is running
2023-10-25 22:29:00,366 INFO Request is running
2023-10-25 22:29:02,643 INFO Request is completed
2023-10-25 22:29:02,643 INFO Request is completed
2023-10-25 22:29:02,643 INFO Downloading https://download-0017.copernicus-climate.eu/cache-compute-0017/cache/data1/adaptor.mars.internal-1698265739.243076-8774-18-b84500d5-1de7-4707-a2cd-fbcf8fdfe7bf.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-eb9fd70b8709640f9992e11d5da8c1b6054b4061b2782cb3f8729c56a81ec5c3.cache.tmp (15.8M)
2023-10-25 22:29:02,643 INFO Downloading https://download-0017.copernicus-climate.eu/cache-compute-0017/cache/data1/adaptor.mars.internal-1698265739.243076-8774-18-b84500d5-1de7-4707-a2cd-fbcf8fdfe7bf.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-eb9fd70b8709640f9992e11d5da8c1b6054b4061b2782cb3f8729c56a81ec5c3.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s]  7%|▋         | 1.10M/15.8M [00:00<00:01, 11.2MB/s] 49%|████▉     | 7.79M/15.8M [00:00<00:00, 45.4MB/s] 92%|█████████▏| 14.6M/15.8M [00:00<00:00, 57.4MB/s]                                                    2023-10-25 22:29:03,063 INFO Download rate 37.8M/s
2023-10-25 22:29:03,063 INFO Download rate 37.8M/s
2023-10-25 22:29:03,093 INFO Loading pressure fields from CDS
2023-10-25 22:29:03,115 INFO Welcome to the CDS
2023-10-25 22:29:03,115 INFO Welcome to the CDS
2023-10-25 22:29:03,115 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:29:03,115 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:29:03,190 INFO Request is queued
2023-10-25 22:29:03,190 INFO Request is queued
2023-10-25 22:29:04,214 INFO Request is running
2023-10-25 22:29:04,214 INFO Request is running
2023-10-25 22:29:11,413 INFO Request is completed
2023-10-25 22:29:11,413 INFO Request is completed
2023-10-25 22:29:11,414 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data8/adaptor.mars.internal-1698265743.4607925-13781-14-166ffa9e-a955-4933-88ce-f9cec0355302.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-3e32f9c9fa7de4709494d87f3fa1f3cb539b8aad48d116f858368b4b186d192b.cache.tmp (154.5M)
2023-10-25 22:29:11,414 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data8/adaptor.mars.internal-1698265743.4607925-13781-14-166ffa9e-a955-4933-88ce-f9cec0355302.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-3e32f9c9fa7de4709494d87f3fa1f3cb539b8aad48d116f858368b4b186d192b.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  1%|          | 850k/154M [00:00<00:19, 8.37MB/s]  4%|▍         | 6.71M/154M [00:00<00:03, 39.2MB/s]  9%|▉         | 13.6M/154M [00:00<00:02, 53.9MB/s] 13%|█▎        | 20.3M/154M [00:00<00:02, 60.7MB/s] 18%|█▊        | 27.3M/154M [00:00<00:02, 65.0MB/s] 22%|██▏       | 34.1M/154M [00:00<00:01, 67.4MB/s] 27%|██▋       | 41.0M/154M [00:00<00:01, 69.0MB/s] 31%|███       | 47.9M/154M [00:00<00:01, 69.8MB/s] 35%|███▌      | 54.6M/154M [00:00<00:01, 70.1MB/s] 40%|███▉      | 61.3M/154M [00:01<00:01, 63.7MB/s] 44%|████▍     | 68.0M/154M [00:01<00:01, 65.6MB/s] 48%|████▊     | 74.8M/154M [00:01<00:01, 67.2MB/s] 53%|█████▎    | 81.7M/154M [00:01<00:01, 68.6MB/s] 57%|█████▋    | 88.6M/154M [00:01<00:00, 69.8MB/s] 62%|██████▏   | 95.5M/154M [00:01<00:00, 70.6MB/s] 66%|██████▋   | 102M/154M [00:01<00:00, 71.2MB/s]  71%|███████   | 109M/154M [00:01<00:00, 71.2MB/s] 75%|███████▌  | 116M/154M [00:01<00:00, 71.5MB/s] 80%|███████▉  | 123M/154M [00:01<00:00, 71.7MB/s] 84%|████████▍ | 130M/154M [00:02<00:00, 71.9MB/s] 89%|████████▊ | 137M/154M [00:02<00:00, 71.9MB/s] 93%|█████████▎| 144M/154M [00:02<00:00, 72.1MB/s] 97%|█████████▋| 151M/154M [00:02<00:00, 72.2MB/s]                                                  2023-10-25 22:29:13,905 INFO Download rate 62M/s
2023-10-25 22:29:13,905 INFO Download rate 62M/s
2023-10-25 22:29:13,961 INFO Welcome to the CDS
2023-10-25 22:29:13,961 INFO Welcome to the CDS
2023-10-25 22:29:13,961 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:29:13,961 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-25 22:29:13,989 INFO Request is queued
2023-10-25 22:29:13,989 INFO Request is queued
2023-10-25 22:29:15,013 INFO Request is running
2023-10-25 22:29:15,013 INFO Request is running
2023-10-25 22:29:22,214 INFO Request is completed
2023-10-25 22:29:22,214 INFO Request is completed
2023-10-25 22:29:22,214 INFO Downloading https://download-0009-clone.copernicus-climate.eu/cache-compute-0009/cache/data4/adaptor.mars.internal-1698265754.1948307-22581-7-4272208a-0640-4096-b7f5-8359954e6d06.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-fe19bab2fd69c49e3c75285c044a20108dad975020193c56e20b4609be25271a.cache.tmp (154.5M)
2023-10-25 22:29:22,214 INFO Downloading https://download-0009-clone.copernicus-climate.eu/cache-compute-0009/cache/data4/adaptor.mars.internal-1698265754.1948307-22581-7-4272208a-0640-4096-b7f5-8359954e6d06.grib to /tmp/34662415/climetlab-lpoulain/cds-retriever-fe19bab2fd69c49e3c75285c044a20108dad975020193c56e20b4609be25271a.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  0%|          | 573k/154M [00:00<00:29, 5.47MB/s]  4%|▎         | 5.67M/154M [00:00<00:04, 33.0MB/s]  8%|▊         | 12.5M/154M [00:00<00:02, 50.4MB/s] 13%|█▎        | 19.4M/154M [00:00<00:02, 58.8MB/s] 17%|█▋        | 25.6M/154M [00:00<00:02, 61.0MB/s] 20%|██        | 31.4M/154M [00:00<00:02, 50.7MB/s] 24%|██▎       | 36.5M/154M [00:01<00:04, 29.0MB/s] 26%|██▌       | 40.4M/154M [00:01<00:05, 22.3MB/s] 28%|██▊       | 43.5M/154M [00:01<00:05, 20.1MB/s] 30%|██▉       | 46.0M/154M [00:01<00:06, 18.8MB/s] 31%|███       | 48.2M/154M [00:01<00:06, 17.8MB/s] 32%|███▏      | 50.1M/154M [00:02<00:06, 17.1MB/s] 34%|███▎      | 51.9M/154M [00:02<00:06, 16.7MB/s] 35%|███▍      | 53.6M/154M [00:02<00:06, 16.2MB/s] 36%|███▌      | 55.2M/154M [00:02<00:06, 15.5MB/s] 37%|███▋      | 56.7M/154M [00:02<00:08, 12.7MB/s] 38%|███▊      | 58.0M/154M [00:02<00:09, 10.4MB/s] 38%|███▊      | 59.1M/154M [00:02<00:10, 9.22MB/s] 39%|███▉      | 60.0M/154M [00:03<00:11, 8.48MB/s] 39%|███▉      | 60.9M/154M [00:03<00:11, 8.39MB/s] 40%|███▉      | 61.7M/154M [00:03<00:12, 8.05MB/s] 40%|████      | 62.5M/154M [00:03<00:12, 7.97MB/s] 41%|████      | 63.2M/154M [00:03<00:12, 7.91MB/s] 41%|████▏     | 64.0M/154M [00:03<00:11, 8.05MB/s] 42%|████▏     | 64.9M/154M [00:03<00:11, 8.12MB/s] 43%|████▎     | 65.7M/154M [00:03<00:11, 8.24MB/s] 43%|████▎     | 66.6M/154M [00:03<00:10, 8.45MB/s] 44%|████▎     | 67.5M/154M [00:04<00:10, 8.68MB/s] 44%|████▍     | 68.5M/154M [00:04<00:10, 8.87MB/s] 45%|████▍     | 69.5M/154M [00:04<00:09, 9.18MB/s] 46%|████▌     | 70.5M/154M [00:04<00:09, 9.40MB/s] 46%|████▋     | 71.5M/154M [00:04<00:09, 9.50MB/s] 47%|████▋     | 72.5M/154M [00:04<00:08, 9.67MB/s] 48%|████▊     | 73.5M/154M [00:04<00:08, 9.94MB/s] 48%|████▊     | 74.5M/154M [00:04<00:08, 9.61MB/s] 49%|████▉     | 75.4M/154M [00:04<00:09, 9.03MB/s] 49%|████▉     | 76.3M/154M [00:05<00:09, 8.65MB/s] 50%|████▉     | 77.1M/154M [00:05<00:09, 8.52MB/s] 50%|█████     | 77.9M/154M [00:05<00:09, 8.45MB/s] 51%|█████     | 78.8M/154M [00:05<00:09, 8.47MB/s] 52%|█████▏    | 79.7M/154M [00:05<00:09, 8.61MB/s] 52%|█████▏    | 80.6M/154M [00:05<00:08, 8.84MB/s] 53%|█████▎    | 81.5M/154M [00:05<00:08, 8.94MB/s] 53%|█████▎    | 82.5M/154M [00:05<00:08, 9.22MB/s] 54%|█████▍    | 83.5M/154M [00:05<00:07, 9.41MB/s] 55%|█████▍    | 84.5M/154M [00:06<00:07, 9.55MB/s] 55%|█████▌    | 85.5M/154M [00:06<00:07, 9.73MB/s] 56%|█████▌    | 86.6M/154M [00:06<00:07, 10.0MB/s] 57%|█████▋    | 87.7M/154M [00:06<00:06, 10.4MB/s] 57%|█████▋    | 88.8M/154M [00:06<00:06, 10.6MB/s] 58%|█████▊    | 89.9M/154M [00:06<00:06, 10.8MB/s] 59%|█████▉    | 91.0M/154M [00:06<00:06, 10.8MB/s] 60%|█████▉    | 92.1M/154M [00:06<00:06, 10.6MB/s] 60%|██████    | 93.1M/154M [00:06<00:06, 10.5MB/s] 61%|██████    | 94.1M/154M [00:06<00:06, 9.83MB/s] 62%|██████▏   | 95.0M/154M [00:07<00:06, 9.70MB/s] 62%|██████▏   | 96.0M/154M [00:07<00:07, 8.69MB/s] 63%|██████▎   | 96.8M/154M [00:07<00:07, 7.94MB/s] 63%|██████▎   | 97.6M/154M [00:07<00:07, 7.85MB/s] 64%|██████▎   | 98.3M/154M [00:07<00:07, 7.48MB/s] 64%|██████▍   | 99.1M/154M [00:07<00:07, 7.36MB/s] 65%|██████▍   | 99.8M/154M [00:07<00:08, 6.94MB/s] 65%|██████▌   | 100M/154M [00:07<00:08, 6.56MB/s]  65%|██████▌   | 101M/154M [00:08<00:08, 6.24MB/s] 66%|██████▌   | 102M/154M [00:08<00:08, 6.17MB/s] 66%|██████▌   | 102M/154M [00:08<00:09, 6.04MB/s] 67%|██████▋   | 103M/154M [00:08<00:09, 5.47MB/s] 67%|██████▋   | 103M/154M [00:08<00:09, 5.41MB/s] 67%|██████▋   | 104M/154M [00:08<00:10, 5.07MB/s] 68%|██████▊   | 104M/154M [00:08<00:10, 5.03MB/s] 68%|██████▊   | 105M/154M [00:08<00:10, 4.75MB/s] 68%|██████▊   | 105M/154M [00:09<00:11, 4.51MB/s] 68%|██████▊   | 106M/154M [00:09<00:11, 4.50MB/s] 69%|██████▉   | 106M/154M [00:09<00:11, 4.57MB/s] 69%|██████▉   | 107M/154M [00:09<00:10, 4.67MB/s] 69%|██████▉   | 107M/154M [00:09<00:10, 4.86MB/s] 70%|██████▉   | 108M/154M [00:09<00:09, 5.06MB/s] 70%|███████   | 108M/154M [00:09<00:09, 5.25MB/s] 71%|███████   | 109M/154M [00:09<00:08, 5.50MB/s] 71%|███████   | 110M/154M [00:09<00:08, 5.70MB/s] 71%|███████▏  | 110M/154M [00:09<00:07, 5.95MB/s] 72%|███████▏  | 111M/154M [00:10<00:07, 6.18MB/s] 72%|███████▏  | 112M/154M [00:10<00:07, 6.05MB/s] 73%|███████▎  | 112M/154M [00:10<00:07, 5.67MB/s] 73%|███████▎  | 113M/154M [00:10<00:07, 5.60MB/s] 73%|███████▎  | 113M/154M [00:10<00:07, 5.54MB/s] 74%|███████▎  | 114M/154M [00:10<00:07, 5.56MB/s] 74%|███████▍  | 114M/154M [00:10<00:07, 5.70MB/s] 74%|███████▍  | 115M/154M [00:10<00:07, 5.83MB/s] 75%|███████▍  | 116M/154M [00:10<00:06, 6.07MB/s] 75%|███████▌  | 116M/154M [00:11<00:06, 6.24MB/s] 76%|███████▌  | 117M/154M [00:11<00:06, 6.37MB/s] 76%|███████▌  | 118M/154M [00:11<00:05, 6.64MB/s] 77%|███████▋  | 118M/154M [00:11<00:05, 6.87MB/s] 77%|███████▋  | 119M/154M [00:11<00:05, 7.02MB/s] 78%|███████▊  | 120M/154M [00:11<00:05, 7.19MB/s] 78%|███████▊  | 121M/154M [00:11<00:04, 7.53MB/s] 79%|███████▊  | 122M/154M [00:11<00:04, 7.77MB/s] 79%|███████▉  | 122M/154M [00:11<00:04, 7.94MB/s] 80%|███████▉  | 123M/154M [00:11<00:03, 8.19MB/s] 80%|████████  | 124M/154M [00:12<00:03, 8.51MB/s] 81%|████████  | 125M/154M [00:12<00:03, 8.74MB/s] 82%|████████▏ | 126M/154M [00:12<00:03, 9.00MB/s] 82%|████████▏ | 127M/154M [00:12<00:03, 9.28MB/s] 83%|████████▎ | 128M/154M [00:12<00:02, 9.47MB/s] 84%|████████▎ | 129M/154M [00:12<00:02, 9.64MB/s] 84%|████████▍ | 130M/154M [00:12<00:02, 9.79MB/s] 85%|████████▍ | 131M/154M [00:12<00:02, 10.2MB/s] 86%|████████▌ | 132M/154M [00:12<00:02, 10.5MB/s] 86%|████████▋ | 134M/154M [00:13<00:02, 10.7MB/s] 87%|████████▋ | 135M/154M [00:13<00:01, 10.8MB/s] 88%|████████▊ | 136M/154M [00:13<00:01, 10.9MB/s] 89%|████████▊ | 137M/154M [00:13<00:01, 11.3MB/s] 89%|████████▉ | 138M/154M [00:13<00:01, 11.6MB/s] 90%|█████████ | 139M/154M [00:13<00:01, 11.8MB/s] 91%|█████████ | 141M/154M [00:13<00:01, 12.0MB/s] 92%|█████████▏| 142M/154M [00:13<00:01, 12.3MB/s] 93%|█████████▎| 143M/154M [00:13<00:00, 12.5MB/s] 94%|█████████▎| 145M/154M [00:13<00:00, 12.6MB/s] 94%|█████████▍| 146M/154M [00:14<00:00, 12.9MB/s] 95%|█████████▌| 147M/154M [00:14<00:00, 13.1MB/s] 96%|█████████▋| 149M/154M [00:14<00:00, 13.4MB/s] 97%|█████████▋| 150M/154M [00:14<00:00, 13.7MB/s] 98%|█████████▊| 152M/154M [00:14<00:00, 13.6MB/s] 99%|█████████▉| 153M/154M [00:14<00:00, 12.7MB/s]100%|█████████▉| 154M/154M [00:14<00:00, 12.5MB/s]                                                  2023-10-25 22:29:37,113 INFO Download rate 10.4M/s
2023-10-25 22:29:37,113 INFO Download rate 10.4M/s
2023-10-25 22:29:46,435 INFO Creating forcing variables: 8 seconds.
2023-10-25 22:29:49,817 INFO Converting GRIB to xarray: 3 seconds.
2023-10-25 22:29:50,865 INFO Reindexing: 1 second.
2023-10-25 22:29:50,890 INFO Creating training data: 54 seconds.
2023-10-25 22:29:52,934 INFO Extracting input targets: 1 second.
2023-10-25 22:29:52,934 INFO Creating input data (total): 56 seconds.
2023-10-25 22:29:53,261 INFO Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: Host CUDA Interpreter
2023-10-25 22:29:53,262 INFO Unable to initialize backend 'tpu': module 'jaxlib.xla_extension' has no attribute 'get_tpu_client'
2023-10-25 22:29:53,262 INFO Unable to initialize backend 'plugin': xla_extension has no attributes named get_plugin_device_client. Compile TensorFlow with //tensorflow/compiler/xla/python:enable_plugin_device set to true (defaults to false) to enable this.
2023-10-25 22:31:12.715169: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 1s:

  %pad.149 = bf16[3114720,8]{1,0} pad(bf16[3114720,4]{1,0} %constant.365, bf16[] %constant.768), padding=0_0x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/mesh2grid_gnn/_embed/mesh2grid_gnn/sequential/encoder_edges_mesh2grid_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:31:22.389229: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 10.674108888s
Constant folding an instruction is taking > 1s:

  %pad.149 = bf16[3114720,8]{1,0} pad(bf16[3114720,4]{1,0} %constant.365, bf16[] %constant.768), padding=0_0x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/mesh2grid_gnn/_embed/mesh2grid_gnn/sequential/encoder_edges_mesh2grid_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:31:24.793914: E external/xla/xla/service/slow_operation_alarm.cc:65] Constant folding an instruction is taking > 2s:

  %pad.1 = bf16[1618752,8]{1,0} pad(bf16[1618745,4]{1,0} %constant.374, bf16[] %constant.687), padding=0_7x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/grid2mesh_gnn/_embed/grid2mesh_gnn/sequential/encoder_edges_grid2mesh_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:31:28.392193: E external/xla/xla/service/slow_operation_alarm.cc:133] The operation took 5.598323815s
Constant folding an instruction is taking > 2s:

  %pad.1 = bf16[1618752,8]{1,0} pad(bf16[1618745,4]{1,0} %constant.374, bf16[] %constant.687), padding=0_7x0_4, metadata={op_name="jit(<unnamed wrapped function>)/jit(main)/while/body/remat/grid2mesh_gnn/_embed/grid2mesh_gnn/sequential/encoder_edges_grid2mesh_mlp/linear_0/dot_general[dimension_numbers=(((2,), (0,)), ((), ())) precision=None preferred_element_type=None]" source_file="/work/FAC/FGSE/IDYST/tbeucler/default/louis/graphcast_venv/lib/python3.10/site-packages/haiku/_src/basic.py" source_line=180}

This isn't necessarily a bug; constant-folding is inherently a trade-off between compilation time and speed at runtime. XLA has some guards that attempt to keep constant folding from taking too long, but fundamentally you'll always be able to come up with an input program that takes a long time.

If you'd like to file a bug, run with envvar XLA_FLAGS=--xla_dump_to=/tmp/foo and attach the results.
2023-10-25 22:31:48,894 INFO Doing full rollout prediction in JAX: 1 minute 55 seconds.
2023-10-25 22:31:48,894 INFO Converting output xarray to GRIB and saving
2023-10-25 22:32:47,152 INFO Saving output data: 58 seconds.
2023-10-25 22:32:47,194 INFO Total time: 3 minutes 52 seconds.

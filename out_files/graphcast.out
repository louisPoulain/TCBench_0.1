2023-10-20 13:51:19,156 INFO Writing results to /scratch/lpoulain/graphcast/graphcast-{step}h.grib.
/users/lpoulain/louis/graphcast_venv/lib/python3.10/site-packages/gribapi/__init__.py:23: UserWarning: ecCodes 2.31.0 or higher is recommended. You are running version 2.30.0
  warnings.warn(
2023-10-20 13:51:19,967 INFO Model description: 
GraphCast model at 0.25deg resolution, with 13 pressure levels. This model is
trained on ERA5 data from 1979 to 2017, and fine-tuned on HRES-fc0 data from
2016 to 2021 and can be causally evaluated on 2022 and later years. This model
does not take `total_precipitation_6hr` as inputs and can make predictions in an
operational setting (i.e., initialised from HRES-fc0).

2023-10-20 13:51:19,968 INFO Model license: 
The model weights are licensed under the Creative Commons
Attribution-NonCommercial-ShareAlike 4.0 International (CC BY-NC-SA 4.0). You
may obtain a copy of the License at:
https://creativecommons.org/licenses/by-nc-sa/4.0/.
The weights were trained on ERA5 data, see README for attribution statement.

2023-10-20 13:51:19,968 INFO Loading params/GraphCast_operational - ERA5-HRES 1979-2021 - resolution 0.25 - pressure levels 13 - mesh 2to6 - precipitation output only.npz: 0.8 second.
2023-10-20 13:51:19,968 INFO Building model: 0.8 second.
2023-10-20 13:51:19,968 INFO Loading surface fields from CDS
2023-10-20 13:51:20,714 INFO Welcome to the CDS
2023-10-20 13:51:20,714 INFO Welcome to the CDS
2023-10-20 13:51:20,715 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-20 13:51:20,715 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-20 13:51:20,990 INFO Request is completed
2023-10-20 13:51:20,990 INFO Request is completed
2023-10-20 13:51:20,990 INFO Downloading https://download-0010-clone.copernicus-climate.eu/cache-compute-0010/cache/data8/adaptor.mars.internal-1697527557.0227063-15046-15-c995902b-7b1a-4241-a680-48fbd2a72d1b.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-7e36f139eacf23f00be18bd9dbf4952e59a9416e6b05ed07facfd48f0a3f6513.cache.tmp (15.8M)
2023-10-20 13:51:20,990 INFO Downloading https://download-0010-clone.copernicus-climate.eu/cache-compute-0010/cache/data8/adaptor.mars.internal-1697527557.0227063-15046-15-c995902b-7b1a-4241-a680-48fbd2a72d1b.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-7e36f139eacf23f00be18bd9dbf4952e59a9416e6b05ed07facfd48f0a3f6513.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s]  5%|▍         | 745k/15.8M [00:00<00:02, 7.20MB/s] 12%|█▏        | 1.89M/15.8M [00:00<00:01, 9.75MB/s] 21%|██        | 3.33M/15.8M [00:00<00:01, 11.8MB/s] 32%|███▏      | 5.06M/15.8M [00:00<00:00, 14.0MB/s] 43%|████▎     | 6.77M/15.8M [00:00<00:00, 15.0MB/s] 52%|█████▏    | 8.19M/15.8M [00:00<00:00, 14.7MB/s] 61%|██████    | 9.59M/15.8M [00:00<00:00, 14.2MB/s] 69%|██████▉   | 10.9M/15.8M [00:00<00:00, 12.9MB/s] 77%|███████▋  | 12.2M/15.8M [00:00<00:00, 12.4MB/s] 85%|████████▍ | 13.4M/15.8M [00:01<00:00, 12.2MB/s] 92%|█████████▏| 14.6M/15.8M [00:01<00:00, 12.2MB/s]                                                    2023-10-20 13:51:22,403 INFO Download rate 11.2M/s
2023-10-20 13:51:22,403 INFO Download rate 11.2M/s
2023-10-20 13:51:22,490 INFO Welcome to the CDS
2023-10-20 13:51:22,490 INFO Welcome to the CDS
2023-10-20 13:51:22,490 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-20 13:51:22,490 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-single-levels
2023-10-20 13:51:22,636 INFO Request is completed
2023-10-20 13:51:22,636 INFO Request is completed
2023-10-20 13:51:22,636 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data2/adaptor.mars.internal-1697527560.2523534-26736-1-9269bd38-6739-447e-bf5c-8972e7760f7b.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-1e138e162b722e2b794e5e7bfc212ab7b26db9450f850d11a5a67eda38bf8b04.cache.tmp (15.8M)
2023-10-20 13:51:22,636 INFO Downloading https://download-0015-clone.copernicus-climate.eu/cache-compute-0015/cache/data2/adaptor.mars.internal-1697527560.2523534-26736-1-9269bd38-6739-447e-bf5c-8972e7760f7b.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-1e138e162b722e2b794e5e7bfc212ab7b26db9450f850d11a5a67eda38bf8b04.cache.tmp (15.8M)
  0%|          | 0.00/15.8M [00:00<?, ?B/s]  9%|▊         | 1.35M/15.8M [00:00<00:01, 13.8MB/s] 75%|███████▍  | 11.9M/15.8M [00:00<00:00, 69.8MB/s]                                                    2023-10-20 13:51:23,021 INFO Download rate 41.1M/s
2023-10-20 13:51:23,021 INFO Download rate 41.1M/s
2023-10-20 13:51:23,059 INFO Loading pressure fields from CDS
2023-10-20 13:51:23,076 INFO Welcome to the CDS
2023-10-20 13:51:23,076 INFO Welcome to the CDS
2023-10-20 13:51:23,077 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-20 13:51:23,077 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-20 13:51:23,175 INFO Request is completed
2023-10-20 13:51:23,175 INFO Request is completed
2023-10-20 13:51:23,175 INFO Downloading https://download-0007-clone.copernicus-climate.eu/cache-compute-0007/cache/data0/adaptor.mars.internal-1697527563.5245545-29340-8-f9089e0c-1933-46d8-9d09-d189a300313c.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-417c7de3c9bdaceeae7c8e95a539e52e2a214500482431db13a2f90cc66076bc.cache.tmp (154.5M)
2023-10-20 13:51:23,175 INFO Downloading https://download-0007-clone.copernicus-climate.eu/cache-compute-0007/cache/data0/adaptor.mars.internal-1697527563.5245545-29340-8-f9089e0c-1933-46d8-9d09-d189a300313c.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-417c7de3c9bdaceeae7c8e95a539e52e2a214500482431db13a2f90cc66076bc.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  1%|          | 1.35M/154M [00:00<00:11, 13.5MB/s]  8%|▊         | 12.8M/154M [00:00<00:01, 75.0MB/s] 13%|█▎        | 20.0M/154M [00:00<00:02, 68.1MB/s] 19%|█▉        | 29.9M/154M [00:00<00:01, 80.3MB/s] 24%|██▍       | 37.7M/154M [00:00<00:02, 51.9MB/s] 30%|██▉       | 45.9M/154M [00:00<00:01, 57.5MB/s] 36%|███▋      | 56.3M/154M [00:00<00:01, 69.8MB/s] 42%|████▏     | 64.9M/154M [00:01<00:01, 66.0MB/s] 49%|████▊     | 75.1M/154M [00:01<00:01, 75.9MB/s] 56%|█████▌    | 86.7M/154M [00:01<00:00, 87.8MB/s] 62%|██████▏   | 95.8M/154M [00:01<00:00, 87.0MB/s] 68%|██████▊   | 105M/154M [00:01<00:00, 80.9MB/s]  73%|███████▎  | 113M/154M [00:01<00:00, 78.2MB/s] 78%|███████▊  | 120M/154M [00:01<00:00, 75.8MB/s] 83%|████████▎ | 128M/154M [00:01<00:00, 74.4MB/s] 87%|████████▋ | 135M/154M [00:01<00:00, 72.8MB/s] 92%|█████████▏| 142M/154M [00:02<00:00, 72.6MB/s] 97%|█████████▋| 149M/154M [00:02<00:00, 73.1MB/s]                                                  2023-10-20 13:51:25,553 INFO Download rate 65M/s
2023-10-20 13:51:25,553 INFO Download rate 65M/s
2023-10-20 13:51:25,599 INFO Welcome to the CDS
2023-10-20 13:51:25,599 INFO Welcome to the CDS
2023-10-20 13:51:25,599 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-20 13:51:25,599 INFO Sending request to https://cds.climate.copernicus.eu/api/v2/resources/reanalysis-era5-pressure-levels
2023-10-20 13:51:25,721 INFO Request is completed
2023-10-20 13:51:25,721 INFO Request is completed
2023-10-20 13:51:25,721 INFO Downloading https://download-0008-clone.copernicus-climate.eu/cache-compute-0008/cache/data3/adaptor.mars.internal-1697527589.5562832-15294-10-e1799c3a-30e0-4cc8-803a-05c7aca1e767.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-c0495002649b130551e1a8b1d3a7317688967ddf2fa362135a1f87794dd86c26.cache.tmp (154.5M)
2023-10-20 13:51:25,721 INFO Downloading https://download-0008-clone.copernicus-climate.eu/cache-compute-0008/cache/data3/adaptor.mars.internal-1697527589.5562832-15294-10-e1799c3a-30e0-4cc8-803a-05c7aca1e767.grib to /tmp/34478253/climetlab-lpoulain/cds-retriever-c0495002649b130551e1a8b1d3a7317688967ddf2fa362135a1f87794dd86c26.cache.tmp (154.5M)
  0%|          | 0.00/154M [00:00<?, ?B/s]  0%|          | 730k/154M [00:00<00:21, 7.47MB/s]  3%|▎         | 5.10M/154M [00:00<00:05, 27.5MB/s]  9%|▉         | 14.1M/154M [00:00<00:02, 56.4MB/s] 15%|█▌        | 23.6M/154M [00:00<00:02, 64.4MB/s] 20%|█▉        | 30.4M/154M [00:00<00:01, 66.5MB/s] 24%|██▍       | 37.3M/154M [00:00<00:01, 68.4MB/s] 28%|██▊       | 43.8M/154M [00:00<00:01, 65.0MB/s] 32%|███▏      | 50.0M/154M [00:00<00:01, 60.8MB/s] 36%|███▌      | 55.9M/154M [00:01<00:01, 58.3MB/s] 40%|███▉      | 61.5M/154M [00:01<00:01, 57.7MB/s] 43%|████▎     | 67.0M/154M [00:01<00:01, 57.2MB/s] 47%|████▋     | 72.5M/154M [00:01<00:01, 57.4MB/s] 51%|█████     | 78.0M/154M [00:01<00:01, 56.9MB/s] 54%|█████▍    | 83.5M/154M [00:01<00:01, 56.7MB/s] 58%|█████▊    | 89.0M/154M [00:01<00:01, 56.8MB/s] 61%|██████    | 94.4M/154M [00:01<00:01, 56.8MB/s] 65%|██████▍   | 99.8M/154M [00:01<00:01, 56.6MB/s] 68%|██████▊   | 105M/154M [00:01<00:00, 56.8MB/s]  72%|███████▏  | 111M/154M [00:02<00:00, 57.3MB/s] 76%|███████▌  | 117M/154M [00:02<00:00, 58.2MB/s] 79%|███████▉  | 123M/154M [00:02<00:00, 59.5MB/s] 83%|████████▎ | 128M/154M [00:02<00:00, 59.5MB/s] 87%|████████▋ | 134M/154M [00:02<00:00, 60.3MB/s] 91%|█████████ | 140M/154M [00:02<00:00, 60.5MB/s] 95%|█████████▍| 146M/154M [00:02<00:00, 60.4MB/s] 98%|█████████▊| 152M/154M [00:02<00:00, 60.7MB/s]                                                  2023-10-20 13:51:28,609 INFO Download rate 53.5M/s
2023-10-20 13:51:28,609 INFO Download rate 53.5M/s
2023-10-20 13:51:32,939 INFO Creating forcing variables: 3 seconds.
2023-10-20 13:51:35,671 INFO Converting GRIB to xarray: 2 seconds.
2023-10-20 13:51:35,992 INFO Reindexing: 0.3 second.
2023-10-20 13:51:36,008 INFO Creating training data: 16 seconds.
2023-10-20 13:51:36,548 INFO Extracting input targets: 0.5 second.
2023-10-20 13:51:36,548 INFO Creating input data (total): 16 seconds.
2023-10-20 13:51:36,980 INFO Unable to initialize backend 'cuda': Found cuSOLVER version 11304, but JAX was built against version 11502, which is newer. The copy of cuSOLVER that is installed must be at least as new as the version against which JAX was built.
2023-10-20 13:51:37,173 INFO Unable to initialize backend 'rocm': NOT_FOUND: Could not find registered platform with name: "rocm". Available platform names are: CUDA
2023-10-20 13:51:37,301 INFO Unable to initialize backend 'tpu': INTERNAL: Failed to open libtpu.so: libtpu.so: cannot open shared object file: No such file or directory
2023-10-20 13:51:37,301 WARNING CUDA backend failed to initialize: Found cuSOLVER version 11304, but JAX was built against version 11502, which is newer. The copy of cuSOLVER that is installed must be at least as new as the version against which JAX was built. (Set TF_CPP_MIN_LOG_LEVEL=0 and rerun for more info.)
/var/spool/slurm/d/job34478253/slurm_script: line 26: 2534006 Killed                  ai-models --download-assets --assets ../graphcast/ --input cds --date 20180110 --time 0000 --lead-time 24 --path '/scratch/lpoulain/graphcast/graphcast-{step}h.grib' graphcast
slurmstepd: error: Detected 1 oom-kill event(s) in StepId=34478253.batch. Some of your processes may have been killed by the cgroup out-of-memory handler.
